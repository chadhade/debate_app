<script type="text/javascript"> 
  	jug.subscribe("debate_" + <%= debate.id %>, function(data){  
		<% if Rails.env.development? or Rails.env.test? %>
			$(".debate[data-id="+ <%= debate.id %> +"]").append(data.argument);
		<% else %>
			$.each(data.argument, function(idx, val) {   
				$(".debate[data-id="+ <%= debate.id %> +"]").append(val);
			});
		<% end %>
 
		if ("<%= current_debater.email %>" == data.current_turn) {
		    <% if Rails.env.development? or Rails.env.test? %>      	
				$(".post_to_debate[data-id="+ <%= debate.id %> +"]").html(data.post_box);
			<% else %>
				$.each(data.post_box, function(idx, val) {    
					$(".post_to_debate[data-id="+ <%= debate.id %> +"]").html(val);
				});
			<% end %>	
		}
		else {
		    <% if Rails.env.development? or Rails.env.test? %> 
			    $(".post_to_debate[data-id="+ <%= debate.id %> +"]").html("");
			<% else %>
				$.each(data.post_box, function(idx, val) { 
					$(".post_to_debate[data-id="+ <%= debate.id %> +"]").html("");
				});
			<% end %>	
		}
		
		if (data.footnotes != "") {
			<% if Rails.env.development? or Rails.env.test? %> 
				document.getElementById("footnotes").innerHTML=data.footnotes;
			<% else %>
				$.each(data.footnotes, function(idx, val) { 
					document.getElementById("footnotes").innerHTML=val;
				});
			<% end %>
		}
		abort_timer[<%= debate.id %>] = 1;  // Stop the previous timer from running
		javascript_countdown.init(data.timers.movingclock, data.timers.staticclock, data.timers.movingposition, data.timers.debateid);
	});
	
	jug.subscribe("debate_" + <%= debate.id %> + "_votes", function(votes){
		if (votes.type == "true") {
			incrementVotesFor(votes.id);
		}
		else {
			incrementVotesAgainst(votes.id);
		}
	});
</script>